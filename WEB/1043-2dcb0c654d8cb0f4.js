"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1043],{42796:function(e,t,r){r.d(t,{CL:function(){return getOrderCancellationReason},Z4:function(){return postOrderCancellationWithdraw},tz:function(){return postOrderCancellation}});var n=r(36503);let getOrderCancellationReason=async()=>{let{data:e}=await n.Z.get("/order-cancellation/reason");return{data:e}},postOrderCancellation=async(e,t)=>{let{data:r}=await n.Z.post("/order-cancellation",e,{params:t&&{phone:t}});return{data:r}},postOrderCancellationWithdraw=async(e,t)=>{let{data:r}=await n.Z.post("/order-cancellation/withdraw",e,{params:t&&{phone:t}});return{data:r}}},89564:function(e,t,r){r.d(t,{fs:function(){return postOrderReturnWithdraw},jZ:function(){return getOrderReturnReason},ty:function(){return postOrderReturn}});var n=r(36503);let getOrderReturnReason=async()=>{let{data:e}=await n.Z.get("/order-return/reason");return{data:e}},postOrderReturn=async(e,t)=>{let{data:r}=await n.Z.post("/order-return",e,{params:t&&{phone:t}});return{data:r}},postOrderReturnWithdraw=async(e,t)=>{let{data:r}=await n.Z.post("/order-return/withdraw",e,{params:t&&{phone:t}});return{data:r}}},71043:function(e,t,r){r.d(t,{Z:function(){return claimRequestForms_ClaimRequestForm}});var n=r(85893),i=r(67294),a=r(5152),l=r.n(a),s=r(87536),d=r(83780),c=r(11163),u=r(54507),o=r(34959),h=r(85930),m=r(92440),x=r(19093),p=r(18078),v=r(25616),j=r(11763),g=r(79557),f=r(87708),y=r(7986),R=r(76531),C=r(54810),orderLists_ClaimRequestList=e=>{let{item:t,orderDetail:r,checkItems:a,type:l,length:s,handleCheckItem:c,isFirstItem:o}=e,{status:m,deliveryOption:x,deliveryGroup:{totalDeliveryPrice:p}={}}=t,{isMobile:k,isDesktop:I}=(0,h.Z)(),w=(0,i.useMemo)(()=>"cancel"===l?t.isValidCancel:t.isValidReturn,[t],r),b=(0,R.li)(t);return(0,n.jsxs)(n.Fragment,{children:[I&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{children:(0,n.jsx)(g.default,{checked:!!a.includes(t.id)||!w,onChange:e=>c(e.target.checked,t.id),disabled:!w})}),(0,n.jsx)("td",{children:(0,n.jsxs)(y._S.z,{col:"90px 1fr",gap:"16px",className:"border",children:[(0,n.jsx)(C.Z,{src:t.product.thumbnailImageUrl,size:90}),(0,n.jsx)(j.Z,{selectData:t,isDetail:"340px"})]})}),"delivery"===x.deliveryMethod?o?(0,n.jsx)("td",{rowSpan:s,children:(0,n.jsxs)(y.Rx.tu,{gap:"8px",children:[(0,n.jsx)(y.Lf.xv,{children:0===p?"무료배송":"".concat((0,d.nz)(p)," 원")}),(0,n.jsxs)(y.Lf.xv,{style:{fontSize:12},children:["택배",x.isPrepaid?"(선불)":"(착불)"]})]})}):r.isIntangible&&(0,n.jsx)("td",{children:(0,n.jsx)(y.Rx.tu,{gap:"8px",children:"-"})}):(0,n.jsx)("td",{children:(0,n.jsx)(y.Rx.tu,{gap:"8px",children:u.Yp[x.deliveryMethod]})}),(0,n.jsx)("td",{children:(0,n.jsx)(y.Rx.gq,{gap:"15px",className:"detailTableLastItem",children:(0,n.jsx)(f.WT,{children:(0,n.jsxs)(y.Rx.tu,{gap:"10px",children:[(0,n.jsx)(y.Lf.xv,{weight:700,children:b}),r.payment.paidDate&&(0,n.jsx)(y.Lf.xv,{style:{fontSize:12},children:(0,v.BF)(r.payment.paidDate)})]})})})})]}),k&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.v2,{gap:"4px",justify:"flex-start",children:(0,n.jsxs)(y.Rx.hs,{gap:"8px",justify:"flex-start",children:[(0,n.jsx)(g.default,{checked:!!a.includes(t.id)||!w,onChange:e=>c(e.target.checked,t.id),disabled:!w}),(0,n.jsx)(y.Lf.xv,{weight:700,children:b}),r.payment.paidDate&&(0,n.jsx)(y.Lf.xv,{weight:400,children:(0,v.BF)(r.payment.paidDate)})]})}),(0,n.jsxs)(f.j$,{children:[(0,n.jsx)(C.Z,{src:t.product.thumbnailImageUrl,size:60}),(0,n.jsx)(j.Z,{selectData:t})]})]})]})},k=r(74150),I=r(59395),w=r(83668),b=r(84515),q=r(67078),L=r(88767),Z=r(41422),tracking_useClaimRequestTrackingEvent=()=>{let{googleAnalytics:e}=(0,Z.Z)(),{data:t}=(0,L.useQuery)(["categories"],()=>(0,b.CP)(),{select:e=>e.data.list}),trackGA=(r,n,i)=>{let a=n.map(e=>{let{product:{id:r,name:n,productPrice:i,discountAmount:a,optionPrice:l,options:s,textOptions:d,categoryIds:c},quantity:u}=e,o=(0,q.Qw)(s,d),h=c&&(0,q.nR)(c,t);return{item_id:r,item_name:n,price:i+l-a,quantity:u,discount:a,item_variant:o,...h}});e.trackRequestClaimEvent(r,a,i)};return{requestClaimTrackEvent:(t,r,n)=>{e&&trackGA(t,r,n)}}},D=r(72287),M=r(4480);let O=l()(Promise.all([r.e(2016),r.e(1155)]).then(r.bind(r,61155)),{loadableGenerated:{webpack:()=>[61155]}}),Q=l()(Promise.all([r.e(2016),r.e(1375)]).then(r.bind(r,51375)),{loadableGenerated:{webpack:()=>[51375]}}),_=l()(Promise.resolve().then(r.bind(r,79557)),{loadableGenerated:{webpack:()=>[79557]}});var claimRequestForms_ClaimRequestForm=e=>{var t,r,a;let{orderDetail:l,type:v,isGuest:j}=e,[g,R]=(0,i.useState)([]),[C,b]=(0,i.useState)(),{isMobile:q,isDesktop:L}=(0,h.Z)(),Z=(0,c.useRouter)(),{phone:E,orderNo:S,item:F}=Z.query,P=(null===(t=Z.query)||void 0===t?void 0:t.cancel)||(null===(r=Z.query)||void 0===r?void 0:r.return),z=null==l?void 0:l.payment.useEscrow,A=(0,s.cI)({mode:"onChange",defaultValues:{cancelReason:"",cancelReasonDetail:"",returnReason:"",returnReasonDetail:"",returnPaymentWay:"",bank:"",account:"",accountHolder:"",depositBank:""}}),{handleSubmit:W,control:B,formState:{errors:N,isDirty:V}}=A,[T,G,$]=(0,s.qo)({control:B,name:["depositBank","returnReason","returnPaymentWay"]}),{openConfirmPopup:H}=(0,w.Z)(),{requestClaimTrackEvent:Y}=tracking_useClaimRequestTrackingEvent(),{totalRefundPrice:J}=(0,M.sJ)(D.t),[U,X]=(0,i.useState)(!1),handleRouteAfterRequest=()=>{Y(l.no,et,J);let e="cancel"===v?"취소":"반품";H({message:"".concat(e,"요청이 완료되었습니다."),onConfirm:()=>{Z.push(j?"/guest/order/".concat(S,"?phone=").concat(E):"/mypage?claim")}})},K=(0,m.$)({onSuccess:handleRouteAfterRequest,params:{phone:j&&E}}),ee=(0,x.E)({onSuccess:handleRouteAfterRequest,params:{phone:j&&E}}),et=(0,i.useMemo)(()=>null==l?void 0:l.items.filter(e=>g.includes(e.id)),[l,g]),er=(0,i.useMemo)(()=>null==l?void 0:l.items,[l]),en=(0,i.useCallback)(()=>null==l?void 0:l.items.filter(e=>"cancel"===v?e.isValidCancel:e.isValidReturn).map(e=>e.id),[v,l]),handleCheckAll=e=>{e?R(en()):R([])},handleCheckItem=(e,t)=>(e?R(e=>[...e,t].sort((e,t)=>e-t)):R(g.filter(e=>e!==t)),!1),ei=(0,i.useCallback)(async e=>{var t;let r=(null===(t=en())||void 0===t?void 0:t.length)===(null==g?void 0:g.length);if(z&&!r)return b("에스크로를 통해 결제된 주문 건의 경우 \n 부분 취소, 부분 반품이 불가합니다.");if("cancel"===v){let t={...(0,o.ei)(e),orderId:parseInt(l.id),orderItemIds:g};K.mutate(t);return}if((null==$?void 0:$.code)==="exclude_refund"&&!U)return b("반품비용이 환불가능한 총액보다 큽니다. \n다른 반품비용 결제 방식을 선택해 주세요.");let n={...(0,o.kl)(e),orderId:parseInt(l.id),orderItemIds:g};ee.mutate(n)},[P,g,$,U]);return(0,i.useEffect)(()=>{R([+F])},[F]),(0,n.jsxs)(f.c3,{children:[(0,n.jsx)(p.Z,{orderDetail:l}),(0,n.jsx)(y.R9.OJ,{children:(0,n.jsx)(y.Ld.js,{})}),(0,n.jsx)(s.RV,{...A,children:(0,n.jsxs)("form",{onSubmit:W(ei),children:[L&&(0,n.jsxs)(f.zP,{children:[(0,n.jsx)(y.Lf.xv,{size:"lg",weight:"bold",style:{marginBottom:15},children:"주문 정보"}),(0,n.jsxs)(f.vn,{children:[(0,n.jsx)(f.IL,{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(_,{checked:null!==(a=en())&&void 0!==a&&!!a.length&&en().length===g.length,onChange:e=>handleCheckAll(e.target.checked)})}),(0,n.jsx)("th",{children:"주문 상품 정보"}),(0,n.jsx)("th",{children:"배송비"}),(0,n.jsx)("th",{children:"주문 상태"})]})}),(0,n.jsx)(f.er,{children:null==er?void 0:er.map((e,t)=>{let{deliveryOption:r,deliveryGroup:i}=e,a=(null==i?void 0:i.itemIds[0])===e.id;return(0,n.jsxs)("tr",{children:["delivery"!==r.deliveryMethod&&(0,n.jsx)(orderLists_ClaimRequestList,{handleCheckItem:handleCheckItem,type:v,item:e,orderDetail:l,checkItems:g}),"delivery"===r.deliveryMethod&&(0,n.jsx)(orderLists_ClaimRequestList,{type:v,item:e,orderDetail:l,checkItems:g,handleCheckItem:handleCheckItem,isFirstItem:a,length:a?i.itemIds.length:0})]},"claim-".concat(t))})})]})]}),q&&(0,n.jsx)(f.iO,{children:er.map((e,t)=>{let{deliveryOption:r,deliveryGroup:a}=e,s=!!a&&a.itemIds[0]===e.id,c=!!a&&a.itemIds[a.itemIds.length-1]===e.id;return(0,n.jsxs)(i.Fragment,{children:["delivery"!==r.deliveryMethod&&(0,n.jsx)(f.NZ,{style:{borderTop:s&&0===t?"1px solid black":s?"1px solid ".concat(I.$.grayscale.gray[200]):"none"},children:(0,n.jsxs)(f.AF,{children:[(0,n.jsx)(orderLists_ClaimRequestList,{handleCheckItem:handleCheckItem,type:v,item:e,orderDetail:l,checkItems:g}),(0,n.jsx)(y.Rx.tu,{className:"groupDelivery",children:(0,n.jsx)(y.Lf.xv,{align:"center",children:u.Yp[r.deliveryMethod]||"택배"})})]})}),"delivery"===r.deliveryMethod&&(0,n.jsxs)(f.NZ,{style:{borderTop:!s&&"none"},children:[(0,n.jsx)(orderLists_ClaimRequestList,{handleCheckItem:handleCheckItem,type:v,item:e,orderDetail:l,checkItems:g,isFirstItem:s,length:s?a.itemIds.length:0}),c&&(0,n.jsx)(f.AF,{style:{marginBottom:c&&t!==er.length-1?40:0},children:(0,n.jsxs)(y.Rx.gq,{className:"groupDelivery",gap:"6px",children:["delivery"===r.deliveryMethod&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Lf.xv,{weight:600,color:"black",children:"배송비"}),(0,n.jsx)(y.Lf.xv,{children:0===a.totalDeliveryPrice?"무료":"".concat((0,d.nz)(a.totalDeliveryPrice)," 원")})]}),(0,n.jsxs)(y.Lf.xv,{align:"center",type:"light",children:[u.Yp[r.deliveryMethod]||"택배",r.isPrepaid?"(선불)":"(착불)"]})]})})]})]},"mobile-claim-".concat(t))})}),(0,n.jsxs)(f.Xf,{children:["cancel"===v&&(0,n.jsx)(O,{selectedArr:et,orderDetailInfo:l,claimDetailCardData:l.payment,checkItemsLength:null==g?void 0:g.length}),"return"===v&&(0,n.jsx)(Q,{selectedArr:et,orderDetailInfo:l,checkItemsLength:null==g?void 0:g.length,isValidDeductByRefund:U,setIsValidDeductByRefund:X})]})]})}),C&&(0,n.jsx)(k.default,{handleClosePopup:()=>b(),children:C})]})}},92440:function(e,t,r){r.d(t,{$:function(){return useRequestOrderCancelMutation},z:function(){return useWithdrawOrderCancelMutation}});var n=r(88767),i=r(42796),a=r(94525),l=r(42738);let useRequestOrderCancelMutation=function(){let{onSuccess:e,onError:t,params:{phone:r}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{handleApiError:l}=(0,a.Z)();return(0,n.useMutation)(e=>(0,i.tz)(e,r),{onSuccess:t=>{let{data:r}=t;e&&e(r)},onError:e=>{l(e),t&&t(e)}})},useWithdrawOrderCancelMutation=function(){let{onSuccess:e,onError:t,params:{phone:r}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{handleApiError:s}=(0,a.Z)(),d=(0,n.useQueryClient)(),invalidateQueries=()=>{d.invalidateQueries(l.El),d.invalidateQueries(l.yH),d.invalidateQueries(l.pn),d.invalidateQueries(l.bI),d.invalidateQueries(l.Ov)};return(0,n.useMutation)(e=>(0,i.Z4)(e,r),{onSuccess:t=>{let{data:r}=t;invalidateQueries(),e&&e(r)},onError:e=>{s(e),t&&t(e)}})}},19093:function(e,t,r){r.d(t,{E:function(){return useRequestOrderReturnMutation},R:function(){return useWithdrawOrderReturnMutation}});var n=r(88767),i=r(94525),a=r(89564),l=r(42738);let useRequestOrderReturnMutation=function(){let{onSuccess:e,onError:t,params:{phone:r}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{handleApiError:l}=(0,i.Z)();return(0,n.useMutation)(e=>(0,a.ty)(e,r),{onSuccess:t=>{let{data:r}=t;e&&e(r)},onError:e=>{l(e),t&&t(e)}})},useWithdrawOrderReturnMutation=function(){let{onSuccess:e,onError:t,params:{phone:r}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{handleApiError:s}=(0,i.Z)(),d=(0,n.useQueryClient)(),invalidateQueries=()=>{d.invalidateQueries(l.El),d.invalidateQueries(l.yH),d.invalidateQueries(l.pn),d.invalidateQueries(l.bI),d.invalidateQueries(l.Ov)};return(0,n.useMutation)(e=>(0,a.fs)(e,r),{onSuccess:t=>{let{data:r}=t;invalidateQueries(),e&&e(r)},onError:e=>{s(e),t&&t(e)}})}},72287:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(4480);let i=(0,n.cn)({key:"ClaimRequestInfoState",default:{totalRefundPrice:0}})}}]);